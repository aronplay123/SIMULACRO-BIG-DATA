<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SIMULACRO EXAMEN BIG DATA</title>
  <div class="fecha-examen">
    <h1>üìÖ Fecha del Examen</h1>
    <p class="fecha">07 de Noviembre de 2025</p>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    body {
        font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
        background: linear-gradient(rgba(243, 242, 241, 0.6), rgba(243, 242, 241, 0.6)), url('/img/maletas.jpg');
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        margin: 0;
        padding: 20px;
        min-height: 100vh;
        box-sizing: border-box;
    }
    .container {
        max-width: 800px;
        margin: 0 auto;
        background: transparent;
    }
    .header {
        margin-bottom: 20px;
    }
    h2 {
        color: rgb(50, 49, 48);
        font-size: 24px;
        font-weight: 600;
        margin-bottom: 30px;
    }
    .question {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 4px;
        padding: 24px;
        margin-bottom: 16px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question p {
        color: rgb(50, 49, 48);
        font-size: 16px;
        margin-top: 0;
        margin-bottom: 16px;
    }
    .feedback {
      margin-top: 8px;
      font-weight: 600;
    }
    .correct {
      color: #22c55e;
    }
    .incorrect {
      color: #ef4444;
    }
    button {
        background-color: rgb(0, 120, 212);
        color: white;
        border: none;
        padding: 8px 24px;
        border-radius: 4px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.2s ease;
        display: block;
        margin: 25px auto;
    }
    button:hover {
        background-color: rgb(0, 90, 158);
    }
    label {
        display: block;
        padding: 12px 16px;
        margin: 8px 0;
        background: white;
        border: 1px solid rgb(237, 235, 233);
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    label:hover {
        background: rgb(243, 242, 241);
        border-color: rgb(200, 198, 196);
    }
    #resultadoFinal {
      display: none;
      text-align: center;
      margin: 20px auto;
      padding: 20px;
      background-color: white;
      max-width: 800px;
    }
    #btnDescargar {
        background-color: #107C10;
        margin-top: 20px;
    }
    #btnDescargar:hover {
        background-color: #0B5C0B;
    }
    #btnDescargar:disabled {
        background-color: rgb(237, 235, 233);
        cursor: not-allowed;
    }
    canvas {
      margin: 20px auto;
      max-width: 400px;
      height: auto !important;
    }
    .print-content {
      background-color: white;
      padding: 20px;
      margin: 0 auto;
    }
    .fecha-examen {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 4px;
      padding: 24px;
      margin: 0 auto 16px;
      max-width: 800px;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .fecha-examen h1 {
      color: rgb(50, 49, 48);
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 10px;
    }
    .fecha-examen .fecha {
      color: rgb(0, 120, 212);
      font-size: 22px;
      font-weight: 600;
      margin: 0;
      padding: 8px;
      border-radius: 4px;
      background: rgba(0, 120, 212, 0.1);
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>üß† Evaluaci√≥n Interactiva de Big Data</h2>
    <div id="quiz"></div>
    <button onclick="finalizar()">Finalizar evaluaci√≥n</button>

    <div id="resultadoFinal">
      <h3>üìä Resumen Final</h3>
      <p id="resumenTexto"></p>
      <canvas id="grafico"></canvas>
      <div id="errores"></div>
    </div>
  </div>

  <script>
    const preguntas = [
      {
        texto: "¬øQu√© es el HDFS?",
        opciones: [
          "Un lenguaje de programaci√≥n",
          "Sistema de archivos distribuido de Hadoop",
          "Una base de datos relacional"
        ],
        correcta: 1,
        explicacion: "‚úÖ HDFS (Hadoop Distributed File System) es el sistema que permite almacenar datos distribuidos en varios nodos."
      },
      {
        texto: "¬øQu√© es MapReduce?",
        opciones: [
          "Un algoritmo que divide y procesa datos en paralelo",
          "Un lenguaje para dise√±ar dashboards",
          "Un motor de base de datos"
        ],
        correcta: 0,
        explicacion: "‚úÖ MapReduce permite dividir tareas grandes en peque√±as partes y procesarlas en paralelo dentro de Hadoop."
      },
      {
        texto: "Hadoop procesa los datos r√°pidamente:",
        opciones: ["Verdadero", "Falso"],
        correcta: 1,
        explicacion: "‚úÖ Falso. Hadoop es m√°s lento porque trabaja en disco, aunque maneja gran volumen de datos."
      },
      {
        texto: "¬øCu√°l es el servicio de Big Data en AWS?",
        opciones: ["DataProc", "HDInsight", "EMR"],
        correcta: 2,
        explicacion: "‚úÖ En AWS, el servicio de Big Data es Amazon EMR (Elastic Map Reduce)."
      },
      {
        texto: "¬øQu√© diferencia principal tiene Spark frente a Hadoop?",
        opciones: [
          "Spark procesa en memoria, Hadoop en disco",
          "Hadoop procesa en memoria, Spark en disco",
          "Ambos procesan en memoria"
        ],
        correcta: 0,
        explicacion: "‚úÖ Spark es mucho m√°s r√°pido porque trabaja en memoria RAM, mientras Hadoop lo hace desde el disco."
      },
      {
  texto: "¬øQu√© es YARN en el ecosistema Hadoop?",
  opciones: [
    "Un sistema operativo",
    "Un gestor de recursos y tareas",
    "Un formato de compresi√≥n de datos"
  ],
  correcta: 1,
  explicacion: "‚úÖ YARN (Yet Another Resource Negotiator) coordina los recursos y ejecuta tareas en Hadoop."
},
{
  texto: "¬øCu√°l es la funci√≥n principal de Hive?",
  opciones: [
    "Procesar im√°genes",
    "Facilitar consultas tipo SQL sobre Hadoop",
    "Administrar nodos del cl√∫ster"
  ],
  correcta: 1,
  explicacion: "‚úÖ Hive permite ejecutar consultas tipo SQL sobre datos almacenados en Hadoop."
},
{
  texto: "¬øQu√© herramienta de Hadoop se usa para importar y exportar datos a bases de datos relacionales?",
  opciones: ["Flume", "Sqoop", "Oozie"],
  correcta: 1,
  explicacion: "‚úÖ Sqoop sirve para transferir datos entre Hadoop y bases de datos relacionales."
},
{
  texto: "¬øQu√© hace Apache Flume?",
  opciones: [
    "Recolecta y mueve grandes vol√∫menes de datos de registros (logs)",
    "Analiza texto con IA",
    "Transforma datos en SQL"
  ],
  correcta: 0,
  explicacion: "‚úÖ Flume transporta datos de registro desde m√∫ltiples fuentes hacia HDFS."
},
{
  texto: "¬øQu√© caracter√≠stica tiene Spark Streaming?",
  opciones: [
    "Procesa datos en tiempo real",
    "Solo procesa datos hist√≥ricos",
    "Se usa √∫nicamente en AWS"
  ],
  correcta: 0,
  explicacion: "‚úÖ Spark Streaming permite procesar flujos de datos en tiempo real."
},
{
  texto: "¬øQu√© lenguaje NO es compatible con Apache Spark?",
  opciones: ["Scala", "Python", "PHP"],
  correcta: 2,
  explicacion: "‚úÖ Spark soporta Scala, Python, Java y R, pero no PHP."
},
{
  texto: "¬øQu√© servicio de Google Cloud es equivalente a EMR en AWS?",
  opciones: ["DataProc", "BigQuery", "Dataflow"],
  correcta: 0,
  explicacion: "‚úÖ Google Cloud DataProc es el servicio administrado de Hadoop y Spark en GCP."
},
{
  texto: "¬øQu√© servicio de Azure es equivalente a EMR?",
  opciones: ["HDInsight", "Data Factory", "Synapse"],
  correcta: 0,
  explicacion: "‚úÖ Azure HDInsight es la alternativa de Microsoft para cl√∫steres de Big Data."
},
{
  texto: "¬øQu√© m√≥dulo de Spark permite ejecutar consultas tipo SQL?",
  opciones: ["Spark SQL", "GraphX", "MLlib"],
  correcta: 0,
  explicacion: "‚úÖ Spark SQL permite consultas estructuradas sobre DataFrames y datasets."
},
{
  texto: "¬øQu√© representa el t√©rmino 'Data Lake'?",
  opciones: [
    "Un lago subterr√°neo digital",
    "Un repositorio que guarda datos sin procesar en su formato original",
    "Una base de datos relacional optimizada"
  ],
  correcta: 1,
  explicacion: "‚úÖ Un Data Lake almacena datos crudos en su formato original para su posterior an√°lisis."
},
{
  texto: "¬øQu√© es MLlib en Apache Spark?",
  opciones: [
    "Una herramienta de visualizaci√≥n de datos",
    "Una biblioteca de Machine Learning",
    "Un sistema de almacenamiento en la nube"
  ],
  correcta: 1,
  explicacion: "‚úÖ MLlib es la biblioteca de Spark que ofrece algoritmos y utilidades de Machine Learning."
},
{
  texto: "¬øQu√© es GraphX en Spark?",
  opciones: [
    "Una librer√≠a para gr√°ficos y an√°lisis de grafos",
    "Un motor de base de datos",
    "Un lenguaje de programaci√≥n"
  ],
  correcta: 0,
  explicacion: "‚úÖ GraphX permite realizar an√°lisis y c√°lculos sobre estructuras de grafos en Spark."
},
{
  texto: "¬øQu√© tipo de bases de datos son MongoDB y Cassandra?",
  opciones: [
    "Relacionales",
    "No relacionales (NoSQL)",
    "Basadas en archivos CSV"
  ],
  correcta: 1,
  explicacion: "‚úÖ MongoDB y Cassandra son bases de datos NoSQL dise√±adas para manejar grandes vol√∫menes de datos."
},
{
  texto: "¬øQu√© comando en Spark muestra los primeros registros de un DataFrame?",
  opciones: ["show()", "head()", "display()"],
  correcta: 0,
  explicacion: "‚úÖ El m√©todo show() muestra por defecto los primeros 20 registros de un DataFrame en Spark."
},
{
  texto: "¬øQu√© hace la opci√≥n 'inferSchema' al cargar datos en Spark?",
  opciones: [
    "Adivina autom√°ticamente el tipo de datos de cada columna",
    "Ignora los encabezados del archivo",
    "Elimina las filas vac√≠as"
  ],
  correcta: 0,
  explicacion: "‚úÖ inferSchema permite a Spark detectar autom√°ticamente los tipos de datos de cada columna."
},
{
  texto: "¬øQu√© ocurre si un archivo tiene encabezado y no lo especificas al crear un DataFrame?",
  opciones: [
    "Spark crea una fila adicional con el encabezado como datos",
    "Spark elimina la primera fila",
    "Spark lanza un error y no carga el archivo"
  ],
  correcta: 0,
  explicacion: "‚úÖ Si no se indica header=true, Spark tratar√° la primera fila (el encabezado) como datos."
},
{
  texto: "¬øQu√© librer√≠a se usa para conectar Python con MongoDB?",
  opciones: ["PyMongo", "Pandas", "SQLAlchemy"],
  correcta: 0,
  explicacion: "‚úÖ PyMongo es la librer√≠a oficial de Python para conectarse y trabajar con bases de datos MongoDB."
},
{
  texto: "¬øQu√© significa que un sistema sea distribuido?",
  opciones: [
    "Que funciona en varios nodos o m√°quinas conectadas",
    "Que procesa en un solo computador con mucha RAM",
    "Que depende de una red social"
  ],
  correcta: 0,
  explicacion: "‚úÖ Un sistema distribuido divide el trabajo entre m√∫ltiples m√°quinas para mayor rendimiento y tolerancia a fallos."
},
{
  texto: "¬øQu√© caracter√≠stica hace que Spark sea m√°s r√°pido que Hadoop?",
  opciones: [
    "Procesa los datos directamente en memoria (RAM)",
    "Usa discos duros SSD m√°s r√°pidos",
    "Tiene menos componentes que Hadoop"
  ],
  correcta: 0,
  explicacion: "‚úÖ Spark guarda y procesa los datos en memoria RAM, reduciendo el tiempo de lectura/escritura en disco."
},
{
  texto: "¬øQu√© es DBFS en Databricks?",
  opciones: [
    "Un sistema de archivos distribuido propio de Databricks",
    "Un lenguaje de consulta SQL",
    "Una red de transmisi√≥n de datos"
  ],
  correcta: 0,
  explicacion: "‚úÖ DBFS (Databricks File System) es el sistema de archivos distribuido de Databricks."
},
{
  texto: "¬øQu√© ventaja principal ofrece Spark sobre MapReduce?",
  opciones: [
    "Procesa los datos en memoria, aumentando la velocidad",
    "Utiliza menos nodos en el cl√∫ster",
    "Usa una base de datos interna"
  ],
  correcta: 0,
  explicacion: "‚úÖ Spark es m√°s r√°pido porque procesa los datos directamente en memoria RAM, mientras que MapReduce usa disco."
},
{
  texto: "¬øQu√© componente de Hadoop se encarga del almacenamiento?",
  opciones: ["YARN", "HDFS", "Hive"],
  correcta: 1,
  explicacion: "‚úÖ HDFS (Hadoop Distributed File System) almacena los datos distribuidos en m√∫ltiples nodos del cl√∫ster."
},
{
  texto: "¬øQu√© componente de Hadoop se encarga del procesamiento de tareas?",
  opciones: ["MapReduce", "HDFS", "Sqoop"],
  correcta: 0,
  explicacion: "‚úÖ MapReduce procesa y analiza grandes vol√∫menes de datos distribuidos en Hadoop."
},
{
  texto: "¬øQu√© es Apache Oozie?",
  opciones: [
    "Un coordinador de flujos de trabajo (workflow) para Hadoop",
    "Un lenguaje de programaci√≥n",
    "Una base de datos documental"
  ],
  correcta: 0,
  explicacion: "‚úÖ Oozie coordina la ejecuci√≥n de tareas y flujos de trabajo en el ecosistema Hadoop."
},
{
  texto: "¬øQu√© lenguaje se utiliza com√∫nmente para trabajar con Spark en la nube (Databricks)?",
  opciones: ["Python (PySpark)", "C++", "Go"],
  correcta: 0,
  explicacion: "‚úÖ En Databricks se suele usar PySpark, la API de Python para trabajar con Spark."
},
{
  texto: "¬øQu√© significa que Databricks sea colaborativo?",
  opciones: [
    "Permite a varios usuarios trabajar simult√°neamente en notebooks compartidos",
    "Se conecta con redes sociales",
    "Guarda los datos en carpetas p√∫blicas"
  ],
  correcta: 0,
  explicacion: "‚úÖ Databricks permite que varios usuarios editen y ejecuten notebooks en tiempo real dentro de un mismo Workspace."
},
{
  texto: "¬øCu√°l de los siguientes servicios pertenece al ecosistema de Azure?",
  opciones: ["HDInsight", "DataProc", "EMR"],
  correcta: 0,
  explicacion: "‚úÖ HDInsight es el servicio de Azure equivalente a EMR (AWS) y DataProc (GCP)."
},
{
  texto: "¬øQu√© tipo de datos procesa mejor Spark Streaming?",
  opciones: [
    "Datos en tiempo real o en flujo (streaming)",
    "Datos estructurados est√°ticos",
    "Datos de im√°genes"
  ],
  correcta: 0,
  explicacion: "‚úÖ Spark Streaming est√° dise√±ado para procesar datos en tiempo real conforme se generan."
},
{
  texto: "¬øQu√© se necesita instalar en Python para usar Spark?",
  opciones: ["pyspark", "sparkSQL", "hadoop-py"],
  correcta: 0,
  explicacion: "‚úÖ Se instala la librer√≠a PySpark para poder trabajar con Apache Spark desde Python."
},
{
  texto: "¬øQu√© empresa cre√≥ originalmente Apache Spark?",
  opciones: ["UC Berkeley (AMP Lab)", "Google", "Amazon"],
  correcta: 0,
  explicacion: "‚úÖ Spark fue desarrollado en el laboratorio AMP Lab de la Universidad de California, Berkeley."
},
{
  texto: "¬øQu√© ventaja ofrece Databricks frente a usar Spark localmente?",
  opciones: [
    "Permite colaboraci√≥n en la nube, integraci√≥n con m√∫ltiples servicios y escalabilidad autom√°tica",
    "Requiere menos memoria RAM",
    "No necesita conexi√≥n a internet"
  ],
  correcta: 0,
  explicacion: "‚úÖ Databricks ofrece un entorno colaborativo en la nube que escala autom√°ticamente y se integra con m√∫ltiples fuentes de datos."
},
{
  texto: "¬øQu√© es Delta Lake dentro de Databricks?",
  opciones: [
    "Una extensi√≥n que mejora la confiabilidad y manejo de datos en los Data Lakes",
    "Un lago de datos f√≠sico",
    "Un tipo de gr√°fico estad√≠stico"
  ],
  correcta: 0,
  explicacion: "‚úÖ Delta Lake a√±ade control de versiones, transacciones ACID y calidad a los Data Lakes en Databricks."
},
{
  texto: "¬øQu√© componente de Big Data se encarga del almacenamiento distribuido?",
  opciones: ["HDFS", "Spark SQL", "Kafka"],
  correcta: 0,
  explicacion: "‚úÖ HDFS (Hadoop Distributed File System) almacena grandes vol√∫menes de datos distribuidos entre nodos."
},
{
  texto: "¬øQu√© herramienta se usa para la orquestaci√≥n de flujos de datos en Big Data?",
  opciones: ["Oozie", "Sqoop", "Hive"],
  correcta: 0,
  explicacion: "‚úÖ Apache Oozie coordina y programa flujos de trabajo en entornos Hadoop."
},
{
  texto: "¬øCu√°l es el prop√≥sito principal del Big Data?",
  opciones: [
    "Extraer valor y conocimiento √∫til de grandes vol√∫menes de informaci√≥n",
    "Almacenar datos sin analizarlos",
    "Reducir el tama√±o de los archivos"
  ],
  correcta: 0,
  explicacion: "‚úÖ El objetivo del Big Data es transformar enormes cantidades de datos en informaci√≥n √∫til para la toma de decisiones."
}
    ];

    let correctas = 0;
    let incorrectas = 0;
    let errores = [];

    const quiz = document.getElementById("quiz");
    preguntas.forEach((p, i) => {
      const div = document.createElement("div");
      div.classList.add("question");
      div.innerHTML = `<p><b>${i + 1}. ${p.texto}</b></p>`;
      p.opciones.forEach((op, j) => {
        const id = `p${i}_o${j}`;
        div.innerHTML += `
          <label>
            <input type="radio" name="p${i}" id="${id}" value="${j}" onchange="evaluar(${i}, ${j})">
            ${op}
          </label><br>`;
      });
      div.innerHTML += `<div id="feedback${i}" class="feedback"></div>`;
      quiz.appendChild(div);
    });

    function evaluar(i, j) {
      const fb = document.getElementById(`feedback${i}`);
      if (j === preguntas[i].correcta) {
        fb.textContent = preguntas[i].explicacion;
        fb.className = "feedback correct";
        correctas++;
      } else {
        fb.textContent = "‚ùå Incorrecto";
        fb.className = "feedback incorrect";
        incorrectas++;
        errores.push({ pregunta: preguntas[i].texto, respuesta: preguntas[i].opciones[preguntas[i].correcta] });
      }
      const radios = document.getElementsByName(`p${i}`);
      radios.forEach(r => r.disabled = true);
    }

    function finalizar() {
      const total = preguntas.length;
      const porcentaje = ((correctas / total) * 100).toFixed(1);

      document.getElementById("resultadoFinal").style.display = "block";
      document.getElementById("resumenTexto").innerHTML = `
        ‚úÖ Correctas: <b>${correctas}</b>  
        ‚ùå Incorrectas: <b>${incorrectas}</b><br>
        üìà Porcentaje: <b>${porcentaje}%</b>`;

      const ctx = document.getElementById("grafico").getContext("2d");
      new Chart(ctx, {
        type: "pie",
        data: {
          labels: ["Correctas", "Incorrectas"],
          datasets: [{
            data: [correctas, incorrectas],
            backgroundColor: ["#22c55e", "#ef4444"]
          }]
        },
        options: {
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      });

      let erroresHTML = "<h4>‚ùå Preguntas incorrectas:</h4>";
      errores.forEach(e => {
        erroresHTML += `<p><b>${e.pregunta}</b><br>‚úÖ Respuesta correcta: ${e.respuesta}</p>`;
      });
      document.getElementById("errores").innerHTML = erroresHTML;

      // Agregar bot√≥n de descarga despu√©s de mostrar los resultados
      if (!document.getElementById('btnDescargar')) {
        const btnDescargar = document.createElement('button');
        btnDescargar.id = 'btnDescargar';
        btnDescargar.innerHTML = 'üì• Descargar Reporte PDF';
        btnDescargar.onclick = descargarPDF;
        document.getElementById("resultadoFinal").appendChild(btnDescargar);
      }
    }

    async function descargarPDF() {
      const btnDescargar = document.getElementById('btnDescargar');
      btnDescargar.disabled = true;
      btnDescargar.textContent = 'Generando PDF...';

      try {
        // Preparar el contenido para el PDF
        const resultadoFinal = document.getElementById('resultadoFinal');
        const canvasOriginal = resultadoFinal.querySelector('canvas');
        
        // Clonar el contenido para no modificar el original
        const contenido = document.createElement('div');
        contenido.className = 'print-content';
        contenido.innerHTML = resultadoFinal.innerHTML;
        
        // Reemplazar el canvas con una imagen
        const imgData = canvasOriginal.toDataURL('image/png');
        const img = document.createElement('img');
        img.src = imgData;
        img.style.maxWidth = '400px';
        img.style.margin = '20px auto';
        img.style.display = 'block';
        
        // Reemplazar el canvas en el clon
        const canvasClon = contenido.querySelector('canvas');
        canvasClon.parentNode.replaceChild(img, canvasClon);
        
        // Agregar el contenido temporalmente al documento
        contenido.style.position = 'absolute';
        contenido.style.left = '-9999px';
        document.body.appendChild(contenido);

        // Generar el PDF
        const pdf = new window.jspdf.jsPDF();
        
        // Capturar el contenido como imagen
        const canvas = await html2canvas(contenido, {
          scale: 2,
          useCORS: true,
          backgroundColor: '#ffffff'
        });

        // Eliminar el contenido temporal
        document.body.removeChild(contenido);

        // Calcular dimensiones para ajustar al PDF
        const imgWidth = 210; // A4 width in mm
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        
        // Agregar la imagen al PDF
        pdf.addImage(canvas.toDataURL('image/jpeg', 1.0), 'JPEG', 0, 0, imgWidth, imgHeight);
        
        // Guardar el PDF
        const fecha = new Date().toLocaleDateString('es-ES');
        pdf.save(`Reporte_Evaluacion_BigData_${fecha}.pdf`);

        // Restaurar el bot√≥n
        btnDescargar.disabled = false;
        btnDescargar.textContent = 'üì• Descargar Reporte PDF';
      } catch (error) {
        console.error('Error al generar PDF:', error);
        alert('Hubo un error al generar el PDF. Por favor, intente nuevamente.');
        btnDescargar.disabled = false;
        btnDescargar.textContent = 'üì• Descargar Reporte PDF';
      }
    }
  </script>
</body>
</html>